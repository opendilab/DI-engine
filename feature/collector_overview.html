

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Collector Overview &mdash; DI-engine 0.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Env Manager Overview" href="env_manager_overview.html" />
    <link rel="prev" title="Env Overview" href="env_overview.html" />
    <link href="../_static/css/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> DI-engine
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start/index.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../key_concept/index.html">Key Concept</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro_rl/index.html">Introduction to RL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hands_on/index.html">RL Algorithm Cheat Sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../env_tutorial/index.html">RL Environments Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../distributed/index.html">Distributed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../best_practice/index.html">Best Practice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_doc/index.html">API Doc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Feature</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="algorithm_overview.html">Algorithm Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="policy_overview.html">Policy Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="model_overview.html">Model Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="env_overview.html">Env Overview</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Collector Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#profile-of-speed">Profile of Speed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="env_manager_overview.html">Env Manager Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="replay_buffer_overview.html">Replay Buffer Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="learner_overview.html">Learner Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="wrapper_hook_overview.html">Wrapper &amp; Hook Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="league_overview.html">League Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="hpc_rl_overview.html">DI-hpc Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="orchestrator_overview.html">DI-orchestrator Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="interaction_overview.html">Interaction Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="loader_overview.html">Loader Overview</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guide/index.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_dev/index.html">Tutorial-Developer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architecture/index.html">Architecture Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../specification/index.html">Middleware code specification</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DI-engine</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Feature</a> &raquo;</li>
        
      <li>Collector Overview</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/feature/collector_overview.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="collector-overview">
<h1>Collector Overview<a class="headerlink" href="#collector-overview" title="Permalink to this headline">¶</a></h1>
<div class="section" id="profile-of-speed">
<h2>Profile of Speed<a class="headerlink" href="#profile-of-speed" title="Permalink to this headline">¶</a></h2>
<p>We conduct speed tests of our collector in comparison with Tianshou, under environments with different scales and environment managers with different types.</p>
<p><strong>As the results show, our collector generally outperforms Tianshou’s, especially under environments with large scales or long reset times.</strong></p>
<ul>
<li><p>Settings</p>
<blockquote>
<div><p>We design three environments with different scales, whose parameters are as follows:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 19%" />
<col style="width: 18%" />
<col style="width: 18%" />
<col style="width: 16%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Observation Dim</p></th>
<th class="head"><p>Reset Time</p></th>
<th class="head"><p>Step Time</p></th>
<th class="head"><p>Infer Time</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Small Env</p></td>
<td><p>64</p></td>
<td><p>0.1</p></td>
<td><p>0.005</p></td>
<td><p>0.004</p></td>
</tr>
<tr class="row-odd"><td><p>Middle Env</p></td>
<td><p>300</p></td>
<td><p>0.5</p></td>
<td><p>0.01</p></td>
<td><p>0.008</p></td>
</tr>
<tr class="row-even"><td><p>Big Env</p></td>
<td><p>3000</p></td>
<td><p>2</p></td>
<td><p>0.1</p></td>
<td><p>0.02</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>where Observation Dim means the dimension of the observation, Reset Time, Step Time and Infer Time are the times the collector needs to reset the environment, execute a step of the environment and use the policy to infer a step. In our tests, the three types of Time uniformly fluctuate in <code class="docutils literal notranslate"><span class="pre">[0.4,</span> <span class="pre">1.6]</span></code> times of their original values in the above table.</p>
<p>We conducts tests under sync and async modes, where the collector runs <strong>8</strong> environments in the environment manager. Under sync mode, we set <code class="docutils literal notranslate"><span class="pre">wait_num</span></code> as 8 and the collector waits for all <strong>8</strong> environments, while under async mode, it is <strong>7</strong>. We retain the default values of <code class="docutils literal notranslate"><span class="pre">timeout</span></code> for both our and Tianshou’s  env managers due to the different implementations of the async mode.</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 41%" />
<col style="width: 25%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Wait Num</p></th>
<th class="head"><p>Timeout</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Sync</p></td>
<td><p>8</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-odd"><td><p>Async</p></td>
<td><p>7</p></td>
<td><p>0.01(nx) / None(ts)</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Basically, for each environment, we conduct 4 tests with the env managers under sync and async modes in ours and Tianshou, namely <strong>ours-sync, ours-async, ts-sync, ts-async</strong>. Additionally, we include our base env manager as baseline, namely <strong>ours-base</strong>.</p>
<p>We simulate <strong>300</strong> collections during one test with each collection producing at least <strong>80</strong> samples, and repeat each test 3 times to get the averages and standard variances. To approximate the real-world scenes, we run a pure cpu task to raise the utilization of cpu to ~60% before each test.</p>
</div></blockquote>
</li>
<li><p>Results</p>
<blockquote>
<div><p>The results of speed tests are as follows(unit: second):</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 16%" />
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 14%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>ts-async</p></th>
<th class="head"><p>ts-sync</p></th>
<th class="head"><p>ours-base</p></th>
<th class="head"><p>ours-async</p></th>
<th class="head"><p>ours-sync</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Small Env</p></td>
<td><p>49.54+0.35</p></td>
<td><p>44.63+0.09</p></td>
<td><p>157.70+0.30</p></td>
<td><p>47.60+0.62</p></td>
<td><p>47.19+1.13</p></td>
</tr>
<tr class="row-odd"><td><p>Middle Env</p></td>
<td><p>93.02+0.09</p></td>
<td><p>88.70+0.14</p></td>
<td><p>311.88+0.22</p></td>
<td><p>90.84+0.67</p></td>
<td><p>82.73+1.51</p></td>
</tr>
<tr class="row-even"><td><p>Big Env</p></td>
<td><p>545.07+1.55</p></td>
<td><p>520.52+0.30</p></td>
<td><p>2592.77+0.25</p></td>
<td><p>519.05+1.05</p></td>
<td><p>467.50+2.18</p></td>
</tr>
</tbody>
</table>
<p>We conclude the findings as:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>The speeds of our subprocess collector is 3~5 times of the base collector’s.</p></li>
<li><p>Our collector is faster than Tianshou’s in all of the six settings except the Small Env under sync mode.</p></li>
</ol>
</div></blockquote>
</div></blockquote>
<p>To approximate some environments with large reset times, e.g. Carla and StarCraft2, we further conduct a group of tests with all reset times multiplied by <strong>5</strong> (unit: second):</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 16%" />
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 14%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>ts-async</p></th>
<th class="head"><p>ts-sync</p></th>
<th class="head"><p>ours-base</p></th>
<th class="head"><p>ours-async</p></th>
<th class="head"><p>ours-sync</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Small Env</p></td>
<td><p>55.11+0.10</p></td>
<td><p>45.10+0.08</p></td>
<td><p>176.55+0.05</p></td>
<td><p>50.71+0.80</p></td>
<td><p>50.55+1.39</p></td>
</tr>
<tr class="row-odd"><td><p>Middle Env</p></td>
<td><p>130.49+0.09</p></td>
<td><p>112.27+0.03</p></td>
<td><p>407.65+0.14</p></td>
<td><p>98.49+1.29</p></td>
<td><p>94.18+1.74</p></td>
</tr>
<tr class="row-even"><td><p>Big Env</p></td>
<td><p>703.49+0.61</p></td>
<td><p>577.92+0.30</p></td>
<td><p>2976.80+0.39</p></td>
<td><p>555.15+1.90</p></td>
<td><p>520.31+1.05</p></td>
</tr>
</tbody>
</table>
<p>As shown above, Tianshou’s collector bears drastic speed decreases in such environments compared with our collector, which uses reset threads to avoid busy waiting and remain high performance under large reset times.</p>
</div></blockquote>
</div></blockquote>
</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="env_manager_overview.html" class="btn btn-neutral float-right" title="Env Manager Overview" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="env_overview.html" class="btn btn-neutral float-left" title="Env Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, OpenDILab Contributors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>