

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Interaction Overview &mdash; nerveX 0.2.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Loader Overview" href="loader_overview_en.html" />
    <link rel="prev" title="Autolog Overview" href="autolog_overview.html" />
    <link href="../_static/css/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> nerveX
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start/index.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../key_concept/index.html">Key Concept</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro_rl/index.html">Introduction to RL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hands_on/index.html">Hands on RL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../best_practice/index.html">Best Practice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_doc/index.html">API Doc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Feature</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="algorithm_overview.html">Algorithm Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="policy_overview_en.html">Policy Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="model_overview_en.html">Model Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="env_overview_en.html">Env Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="collector_overview_en.html">Collector Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="env_manager_overview_en.html">Env Manager Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="replay_buffer_overview_en.html">Replay Buffer Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="learner_overview.html">Learner Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="wrapper_hook_overview_en.html">Wrapper &amp; Hook Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="league_overview_en.html">League Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="hpc_rl_overview_en.html">HPC_RL Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataloader_overview.html">DataLoader Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="autolog_overview.html">Autolog Overview</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Interaction Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#slave">Slave</a></li>
<li class="toctree-l3"><a class="reference internal" href="#master">Master</a></li>
<li class="toctree-l3"><a class="reference internal" href="#q-a">Q &amp; A</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#q-what-is-a-non-blocking-single-threaded-task-why-make-this-design">Q: What is a non-blocking single-threaded task? Why make this design?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#q-what-are-the-issues-that-the-interaction-module-is-suitable-for-use">Q: What are the issues that the Interaction module is suitable for use?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#q-what-should-i-do-if-an-error-occurs-when-the-master-and-slave-are-sending-network-requests">Q: What should I do if an error occurs when the Master and Slave are sending network requests?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#q-how-to-correctly-integrate-master-and-slave-into-existing-business-services">Q: How to correctly integrate Master and Slave into existing business services?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="loader_overview_en.html">Loader Overview</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../supplementary_rl/index.html">Supplementary of RL</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guide/index.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_dev/index.html">Tutorial-Developer</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">nerveX</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Feature</a> &raquo;</li>
        
      <li>Interaction Overview</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/feature/interaction_overview_en.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="interaction-overview">
<span id="header-n0"></span><h1>Interaction Overview<a class="headerlink" href="#interaction-overview" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<span id="header-n2"></span><h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Interaction module is an interactive service framework independent of any specific business, which used to support simple non-blocking single-thread tasks. It provides support for training(multi-machine multi-card) in a distributed environment based on nerveX.</p>
<p>Interaction module is divided into two ends, the <code class="docutils literal notranslate"><span class="pre">Master</span></code> and the <code class="docutils literal notranslate"><span class="pre">Slave</span></code>, which are the task release end and the task execution end respectively.</p>
</div>
<div class="section" id="slave">
<span id="header-n9"></span><h2>Slave<a class="headerlink" href="#slave" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Slave</span></code> receives task information from <code class="docutils literal notranslate"><span class="pre">Master</span></code>, executes the task by rewriting the <code class="docutils literal notranslate"><span class="pre">_process_task</span></code> method, and returns the message through the return value and exception raising.</p>
<p>Here is a simple example for building your own <code class="docutils literal notranslate"><span class="pre">Slave</span></code> class by following way:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MySlave</span><span class="p">(</span><span class="n">Slave</span><span class="p">):</span>  <span class="c1"># build a slave class, inheriting from Slave base class</span>
    <span class="k">def</span> <span class="nf">_process_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
        <span class="k">if</span> <span class="s1">&#39;a&#39;</span> <span class="ow">in</span> <span class="n">task</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;b&#39;</span> <span class="ow">in</span> <span class="n">task</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;sum&#39;</span><span class="p">:</span> <span class="n">task</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">task</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TaskFail</span><span class="p">(</span><span class="n">result</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;ab not found&#39;</span><span class="p">},</span> <span class="n">message</span><span class="o">=</span><span class="s1">&#39;A or B not found in task data.&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The logical of this class is that if all parameters <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> exist, the sum of the two is returned in json format, otherwise the <code class="docutils literal notranslate"><span class="pre">TaskFail</span></code> exception will be  raised to indicates that the task execution failed.</p>
<p>There are two ways to call the <code class="docutils literal notranslate"><span class="pre">Slave</span></code> class. The first is to start and close the <code class="docutils literal notranslate"><span class="pre">Slave</span></code> in a normal way:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">slave</span> <span class="o">=</span> <span class="n">MySlave</span><span class="p">(</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="mi">8080</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="mi">233</span><span class="p">)</span>  <span class="c1"># instantiate new slave instance</span>
<span class="n">slave</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>  <span class="c1"># start the slave end</span>

<span class="c1"># do something here</span>

<span class="n">slave</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>  <span class="c1"># shutdown the slave (ATTENTION: slave will not be stopped immediately after this)</span>
<span class="n">slave</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>  <span class="c1"># wait until the slave completely stopped</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;slave has been stopped&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Or using <code class="docutils literal notranslate"><span class="pre">with</span></code> for quick call:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">MySlave</span><span class="p">(</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="mi">8080</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="mi">233</span><span class="p">):</span>  <span class="c1"># start the slave</span>
    <span class="c1"># when this line is reached, all the initialization process has been completed</span>
    <span class="n">run_until_ctrl_c</span><span class="p">()</span>  <span class="c1"># just block here</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;slave has been stopped&quot;</span><span class="p">)</span>  <span class="c1"># after quit the slave with block, all the resources will be automatically released, and wait until slave completely stopped</span>
</pre></div>
</div>
<p>After the calling above, connecting port(<code class="docutils literal notranslate"><span class="pre">8080</span></code>) of the slave on the master and select channel <code class="docutils literal notranslate"><span class="pre">233</span></code> to complete the connection.</p>
<p>Attention:</p>
<ul class="simple">
<li><p>In order to facilitate the realization of the task logic clearly, <strong>please inherit the Slave class and implement the _task_process method</strong>. Do not directly use the Slave class to create the Slave end.</p></li>
<li><p>Channel can be regarded as a kind of identification for different specific services, and its concept is similar to radio channel, network port, etc. <strong>It is recommended to set a specific channel value for a specific task</strong>. Do not directly use a value that is easy to collide, such as 0 or the default, to ensure that you can get feedback immediately when a misconnection occurs.</p></li>
</ul>
</div>
<div class="section" id="master">
<span id="header-n57"></span><h2>Master<a class="headerlink" href="#master" title="Permalink to this headline">¶</a></h2>
<p>The main job of the <code class="docutils literal notranslate"><span class="pre">Master</span></code> is to connect to the <code class="docutils literal notranslate"><span class="pre">Slave</span></code>, and to issue tasks to the <code class="docutils literal notranslate"><span class="pre">Slave</span></code> through the established connection.</p>
<p>Here is a simple example to build your own <code class="docutils literal notranslate"><span class="pre">Master</span></code> class in the following way:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyMaster</span><span class="p">(</span><span class="n">Master</span><span class="p">):</span>  <span class="c1"># build a master class, inherit from master base class</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>Similar to <code class="docutils literal notranslate"><span class="pre">Slave</span></code>, there are two ways to start the <code class="docutils literal notranslate"><span class="pre">Master</span></code>. The first is to start and stop the <code class="docutils literal notranslate"><span class="pre">Master</span></code> in the common way:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">master</span> <span class="o">=</span> <span class="n">MyMaster</span><span class="p">(</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="mi">8088</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="mi">233</span><span class="p">)</span>  <span class="c1"># instantiate new master instance</span>
<span class="n">master</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>  <span class="c1"># start the master end</span>

<span class="c1"># do something here</span>

<span class="n">master</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>  <span class="c1"># shutdown the master (ATTENTION: master will not be stopped immediately)</span>
<span class="n">master</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>  <span class="c1"># wait until the master completely stopped</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;master has been stopped&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Or make a quick call using <code class="docutils literal notranslate"><span class="pre">with</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">MyMaster</span><span class="p">(</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="mi">8088</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="mi">233</span><span class="p">)</span> <span class="k">as</span> <span class="n">master</span><span class="p">:</span>  <span class="c1"># start the master</span>
    <span class="c1"># when this line is reached, all the initialization process has been completed</span>
    <span class="c1"># do anything you like here</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;master has been stopped&quot;</span><span class="p">)</span>  <span class="c1"># after quit the master with block, all the resources will be automatically released, and wait until master completely stopped</span>
</pre></div>
</div>
<p>By using <code class="docutils literal notranslate"><span class="pre">with</span></code>, we can issue tasks, manage tasks, and obtain results in the following ways in <code class="docutils literal notranslate"><span class="pre">Master</span></code>. Combining the <code class="docutils literal notranslate"><span class="pre">Slave</span></code> example above, an example is as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyMaster</span><span class="p">(</span><span class="n">Master</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
 <span class="k">with</span> <span class="n">MyMaster</span><span class="p">(</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="mi">8088</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="mi">233</span><span class="p">)</span> <span class="k">as</span> <span class="n">master</span><span class="p">:</span>
        <span class="n">master</span><span class="o">.</span><span class="n">ping</span><span class="p">()</span>  <span class="c1"># True if master launch success, otherwise False</span>

        <span class="k">with</span> <span class="n">master</span><span class="o">.</span><span class="n">new_connection</span><span class="p">(</span><span class="s1">&#39;conn&#39;</span><span class="p">,</span> <span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="mi">8080</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>  <span class="c1"># establish a connection to slave end</span>
            <span class="c1"># when this line is reached, all the initialization process has been completed</span>

            <span class="k">assert</span> <span class="n">conn</span><span class="o">.</span><span class="n">is_connected</span>  <span class="c1"># check if slave connected success</span>

            <span class="k">assert</span> <span class="s1">&#39;conn&#39;</span> <span class="ow">in</span> <span class="n">master</span>  <span class="c1"># check if connection &#39;conn&#39; still exist and alive in master</span>
            <span class="n">_tmp_conn</span> <span class="o">=</span> <span class="n">master</span><span class="p">[</span><span class="s1">&#39;conn&#39;</span><span class="p">]</span>  <span class="c1"># get connection named &#39;conn&#39; from master</span>
            <span class="k">assert</span> <span class="n">conn</span> <span class="o">==</span> <span class="n">_tmp_conn</span>  <span class="c1"># of course, one object actually</span>

            <span class="n">task</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">new_task</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>  <span class="c1"># create a new task (but has not been sent to slave yet)</span>
            <span class="n">task</span><span class="o">.</span><span class="n">start</span><span class="p">()</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>  <span class="c1"># start the task and waiting for its completeness</span>
            <span class="k">assert</span> <span class="n">task</span><span class="o">.</span><span class="n">result</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;sum&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>  <span class="c1"># get result of task</span>
            <span class="k">assert</span> <span class="n">task</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="n">TaskStatus</span><span class="o">.</span><span class="n">COMPLETED</span>  <span class="c1"># get status of task</span>

            <span class="n">task</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">new_task</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;bb&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>  <span class="c1"># create a new invalid task</span>
            <span class="n">task</span><span class="o">.</span><span class="n">start</span><span class="p">()</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="k">assert</span> <span class="n">task</span><span class="o">.</span><span class="n">result</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;ab not found&#39;</span><span class="p">}</span>  <span class="c1"># get result of task failure</span>
            <span class="k">assert</span> <span class="n">task</span><span class="o">.</span><span class="n">result</span> <span class="o">==</span> <span class="n">TaskStatus</span><span class="o">.</span><span class="n">FAILED</span>  <span class="c1"># get status of task</span>

            <span class="n">_result_value</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">def</span> <span class="nf">_print_result</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
                <span class="k">nonlocal</span> <span class="n">_result_value</span>
                <span class="n">_result_value</span> <span class="o">=</span> <span class="n">result</span>

         <span class="n">task</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">new_task</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span><span class="o">.</span><span class="n">on_complete</span><span class="p">(</span><span class="n">_print_result</span><span class="p">)</span>  <span class="c1"># create a new task with callback</span>
            <span class="n">task</span><span class="o">.</span><span class="n">start</span><span class="p">()</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="k">assert</span> <span class="n">_result_value</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;sum&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>  <span class="c1"># the callback has been triggered</span>
</pre></div>
</div>
<p>In addition, there are more functions and usages, which will be further introduced in the follow-up, and welcome to read the source code.</p>
<p>Attentions:</p>
<ul class="simple">
<li><p>In order to make it convient for the extension of functions, please inherit the Master class and implement a series of methods such as <code class="docutils literal notranslate"><span class="pre">_before_new_task</span></code> when needed. Do not directly use the <code class="docutils literal notranslate"><span class="pre">Master</span></code> class to create the <code class="docutils literal notranslate"><span class="pre">Master</span></code>.</p></li>
<li><p><strong>The channel of the Master and Slave must be set to the same</strong>, otherwise the connection cannot be established normally.</p></li>
</ul>
</div>
<div class="section" id="q-a">
<span id="header-n54"></span><h2>Q &amp; A<a class="headerlink" href="#q-a" title="Permalink to this headline">¶</a></h2>
<div class="section" id="q-what-is-a-non-blocking-single-threaded-task-why-make-this-design">
<span id="header-n13"></span><h3>Q: What is a non-blocking single-threaded task? Why make this design?<a class="headerlink" href="#q-what-is-a-non-blocking-single-threaded-task-why-make-this-design" title="Permalink to this headline">¶</a></h3>
<p>A: That is, <strong>when Master issues a task, if the Slave is idle, the task will be executed; if there is already a task running on the Slave, the task request will be rejected</strong>.</p>
<p>Similarly, there are several task modes, which are defined as follows:</p>
<ul class="simple">
<li><p>Non-blocking multi-thread task: The <code class="docutils literal notranslate"><span class="pre">Slave</span></code> has a maximum number of tasks to excute. When the <code class="docutils literal notranslate"><span class="pre">Master</span></code> issues a task, if the number of tasks being executed has reached the maximum number, the new task request will be rejected.</p></li>
<li><p>Blocking single-thread task: When the <code class="docutils literal notranslate"><span class="pre">Master</span></code> sends a task, if the <code class="docutils literal notranslate"><span class="pre">Slave</span></code> is idle, the task will be executed; if there is already a task running on the Slave side, the new task will be added to the task queue, and the task will be executed after the previous task is completed.</p></li>
<li><p>Blocking multi-thread task: The <code class="docutils literal notranslate"><span class="pre">Slave</span></code> has a maximum number of tasks. When the Master issues a task, if the number of tasks being executed has reached the maximum number, the new task will be added to the task queue and wait for the completion of the previous task before executing.</p></li>
</ul>
<p>Considering <strong>the large amount of concurrent computing in reinforcement learning training, it is not appropriate to disperse computing power on nodes</strong>, and the actual needs of facilitating business-level scheduling management, so the design here is switched to non-blocking single-threaded task mode.</p>
</div>
<div class="section" id="q-what-are-the-issues-that-the-interaction-module-is-suitable-for-use">
<span id="header-n122"></span><h3>Q: What are the issues that the Interaction module is suitable for use?<a class="headerlink" href="#q-what-are-the-issues-that-the-interaction-module-is-suitable-for-use" title="Permalink to this headline">¶</a></h3>
<p>A: Actually, according to the current preliminary investigation, the training tasks will be divided into the following situations:</p>
<ul class="simple">
<li><p><strong>Stand-alone light</strong>. That is, training tasks are performed on a single ordinary computer with or without GPU, such as running demos on their own work machines and laptops.</p></li>
<li><p><strong>Stand-alone distributed</strong>. That is, training tasks are performed on a single computer or cluster with higher computing power. For example, general training tasks are run on environments such as workstations equipped with GPUs and common slurm clusters.</p></li>
<li><p><strong>Multi-machine large-scale distributed</strong>. That is, a collaborative training task is performed on multiple computing nodes. For example, a large-scale training task is run on 100 GPU servers in a common intranet.</p></li>
</ul>
<p>In fact, for a single-machine light-duty, the general operation can be completed. For a single-machine distributed, Interaction is completely unnecessary, because in a single-machine distributed environment, it is possible to start each end by forking the child processes, and do blocking control through <code class="docutils literal notranslate"><span class="pre">Lock</span></code> and <code class="docutils literal notranslate"><span class="pre">Event</span></code>. Its transmission performance and stability will inevitably exceed the HTTP service-based Interaction.</p>
<p>Therefore, <strong>for Interaction, the best environment to show its advantage is a multi-machine large-scale distributed environment</strong>. Specifically, because it is unrealistic to start a fork in a multi-machine environment or start training tasks based on remote startup, it is necessary to build services based on Interaction. In fact, in such an environment, <strong>the best practice is to turn on all service nodes (Slave nodes) in advance, keep them in a long-term standby state, and have dedicated personnel to maintain these computing nodes (analogous to the maintenance of the slurm cluster). When users have training tasks, they will connect a large number of existing nodes, arrange and run training tasks</strong>.</p>
</div>
<div class="section" id="q-what-should-i-do-if-an-error-occurs-when-the-master-and-slave-are-sending-network-requests">
<span id="header-n120"></span><h3>Q: What should I do if an error occurs when the Master and Slave are sending network requests?<a class="headerlink" href="#q-what-should-i-do-if-an-error-occurs-when-the-master-and-slave-are-sending-network-requests" title="Permalink to this headline">¶</a></h3>
<p>A: The network exception thrown is classified in the Interaction framework based on the error code (non-HTTP status code). In actual use, <strong>please be careful not to directly use HTTPError to capture exceptions</strong>. This exception can only capture non-business exceptions (such as DNS failures, connection timeouts, etc.). For business exceptions, please use the corresponding exception class that has been captured, and <strong>it is recommended to use corresponding exception classes according to different business exception types</strong> to accurately capture and handle problems.</p>
</div>
<div class="section" id="q-how-to-correctly-integrate-master-and-slave-into-existing-business-services">
<span id="header-n110"></span><h3>Q: How to correctly integrate Master and Slave into existing business services?<a class="headerlink" href="#q-how-to-correctly-integrate-master-and-slave-into-existing-business-services" title="Permalink to this headline">¶</a></h3>
<p>A: A more recommended way is <strong>to treat Master/Slave as a private attribute of the class and integrated into the class</strong>, and <strong>it is also recommended to properly manage the life cycle for the class itself</strong> (for example, set up start, shutdown, join and other life cycle management methods ), and it is recommended to implement the <code class="docutils literal notranslate"><span class="pre">__enter__</span></code> and <code class="docutils literal notranslate"><span class="pre">__exit__</span></code> methods, so that the class can be quickly created and recycled through <code class="docutils literal notranslate"><span class="pre">with</span></code>.</p>
<p><strong>It is strongly not recommended to directly carry out secondary inheritance of the Master and Slave classes</strong>, because this will cause the structure and life cycle of the Master/Slave itself to be disturbed, and affect its internal logic and data constraints, resulting in unpredictable results.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The secondary inheritance mentioned here refers to: <code class="docutils literal notranslate"><span class="pre">MyMaster</span></code> –&gt; <code class="docutils literal notranslate"><span class="pre">Master</span></code>, <code class="docutils literal notranslate"><span class="pre">Controller</span></code> –&gt; <code class="docutils literal notranslate"><span class="pre">MyMaster</span></code>. <code class="docutils literal notranslate"><span class="pre">Controller</span></code> as a class related to business logic should have a composite relationship with <code class="docutils literal notranslate"><span class="pre">MyMaster</span></code>, and avoid abuse of inheritance. If you want to expand more functions for <code class="docutils literal notranslate"><span class="pre">Master</span></code>, you can also define corresponding function classes, and then let <code class="docutils literal notranslate"><span class="pre">MyMaster</span></code> multiple inherits <code class="docutils literal notranslate"><span class="pre">Master</span></code> and new function classes.</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="loader_overview_en.html" class="btn btn-neutral float-right" title="Loader Overview" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="autolog_overview.html" class="btn btn-neutral float-left" title="Autolog Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, X-Lab.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>